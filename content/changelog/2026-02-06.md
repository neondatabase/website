---
title: Track your usage programmatically with the consumption API
---

## Track your usage programmatically with the consumption API

Two updates to the consumption history API:

1. **New metrics aligned with usage-based pricing**: The new v2 endpoint returns metrics that match Neon's current [usage-based billing](/docs/introduction/plans), so the data you query aligns directly with what you see on your invoice. The previous v1 endpoint only returned metrics for legacy pricing plans.

2. **Now available on Launch plan**: Programmatic access to consumption data was previously limited to Scale and Enterprise plans. Now all paid plan customers, including those on the Launch plan, can query their usage via the API.

The v2 endpoint provides these billing-aligned metrics:

- `compute_unit_seconds`: Compute usage
- `root_branch_bytes_month`: Root branch storage
- `child_branch_bytes_month`: Child branch storage
- `instant_restore_bytes_month`: Instant restore storage
- `public_network_transfer_bytes`: Public network data transfer
- `private_network_transfer_bytes`: Private network data transfer
- `extra_branches_month`: Extra branches

Query your usage at hourly, daily, or monthly granularity to understand your consumption patterns and optimize your costs.

**Query your month-to-date usage:**

<CodeTabs labels={["Compute usage", "Root branch storage", "Child branch storage", "Instant restore", "Network transfer"]}>

```bash
curl --request GET \
     --url 'https://console.neon.tech/api/v2/consumption_history/projects/v2?from=2026-02-01T00%3A00%3A00Z&to=2026-02-06T00%3A00%3A00Z&granularity=daily&org_id=YOUR_ORG_ID&metrics=compute_unit_seconds' \
     --header 'Accept: application/json' \
     --header 'Authorization: Bearer $NEON_API_KEY'
```

```bash
curl --request GET \
     --url 'https://console.neon.tech/api/v2/consumption_history/projects/v2?from=2026-02-01T00%3A00%3A00Z&to=2026-02-06T00%3A00%3A00Z&granularity=daily&org_id=YOUR_ORG_ID&metrics=root_branch_bytes_month' \
     --header 'Accept: application/json' \
     --header 'Authorization: Bearer $NEON_API_KEY'
```

```bash
curl --request GET \
     --url 'https://console.neon.tech/api/v2/consumption_history/projects/v2?from=2026-02-01T00%3A00%3A00Z&to=2026-02-06T00%3A00%3A00Z&granularity=daily&org_id=YOUR_ORG_ID&metrics=child_branch_bytes_month' \
     --header 'Accept: application/json' \
     --header 'Authorization: Bearer $NEON_API_KEY'
```

```bash
curl --request GET \
     --url 'https://console.neon.tech/api/v2/consumption_history/projects/v2?from=2026-02-01T00%3A00%3A00Z&to=2026-02-06T00%3A00%3A00Z&granularity=daily&org_id=YOUR_ORG_ID&metrics=instant_restore_bytes_month' \
     --header 'Accept: application/json' \
     --header 'Authorization: Bearer $NEON_API_KEY'
```

```bash
curl --request GET \
     --url 'https://console.neon.tech/api/v2/consumption_history/projects/v2?from=2026-02-01T00%3A00%3A00Z&to=2026-02-06T00%3A00%3A00Z&granularity=daily&org_id=YOUR_ORG_ID&metrics=public_network_transfer_bytes,private_network_transfer_bytes' \
     --header 'Accept: application/json' \
     --header 'Authorization: Bearer $NEON_API_KEY'
```

</CodeTabs>

For more information, see [Querying consumption metrics](/docs/guides/consumption-metrics#get-project-level-metrics-v2-for-usage-based-plans).

<details>
<summary>**API**</summary>

- You can now set your project's default branch using the [Update Project API](https://api-docs.neon.tech/reference/updateproject) by passing the `default_branch_id` parameter. This makes it easier to automate branch management in CI/CD pipelines and scripts, for example, after a recovery operation or when promoting a development branch to production. The previous default branch is automatically unset.

  ```bash shouldWrap
  curl --request PATCH \
       --url 'https://console.neon.tech/api/v2/projects/{project_id}' \
       --header 'Authorization: Bearer $NEON_API_KEY' \
       --header 'Content-Type: application/json' \
       --data '{"project": {"default_branch_id": "br-example-123456"}}'
  ```

</details>

<details>
<summary>**Tables page**</summary>

- The Drizzle Studio integration that powers the **Tables** page in the Neon Console has been updated to version 1.3.0. This release fixes issues with uppercase letters in enum column types and adding foreign keys. For the full list of improvements, see the [Neon Drizzle Studio Integration Changelog](https://github.com/neondatabase/neon-drizzle-studio-changelog/blob/main/CHANGELOG.md).

</details>
