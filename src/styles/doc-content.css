@layer components {
  .code-block[data-has-filename='true'] {
    > pre {
      @apply rounded-none;
    }
  }

  .admonition-text {
    @apply text-base font-normal leading-normal tracking-tight dark:text-[#D7D8DB];

    a {
      @apply border-b border-transparent font-normal text-secondary-8 no-underline transition-[border-color,opacity] duration-200 ease-in-out hover:border-secondary-8 dark:border-b-0 dark:text-white dark:underline dark:decoration-dotted dark:underline-offset-[3px] dark:hover:opacity-80 sm:break-words;
    }
    p:first-child {
      @apply mt-0;
    }

    p {
      @apply my-3;
    }

    p:last-child {
      @apply mb-0;
    }

    pre {
      @apply overflow-x-auto;
    }
  }

  .table-wrapper {
    @apply 2xl:-mx-4 2xl:overflow-x-auto 2xl:px-4;
  }

  .table {
    @apply my-10 w-full leading-normal 2xl:min-w-[500px];

    .func_table_entry,
    .catalog_table_entry {
      > * {
        margin-top: 0.1em;
        margin-bottom: 0.1em;
        padding-left: 4em;
        text-align: left;
      }

      p {
        @apply my-1;
      }
    }

    .func_signature {
      text-indent: -3.5em;
    }

    .column_definition {
      text-indent: -3.5em;
      word-spacing: 0.25em;
    }
  }

  .tab-item {
    > * {
      &:first-child {
        @apply mt-0;
      }

      &:last-child {
        @apply mb-0;
      }
    }
  }

  .prose-doc {
    @apply max-w-none leading-normal tracking-extra-tight text-gray-new-8 prose-strong:text-gray-new-8 dark:text-gray-new-90 dark:prose-strong:text-gray-new-90;
    @apply prose-headings:font-sans prose-headings:font-semibold prose-headings:leading-tight prose-headings:text-black-new prose-p:my-3 prose-p:leading-normal dark:prose-headings:text-white;
    @apply prose-a:rounded-sm prose-a:font-normal prose-a:text-gray-new-20 prose-a:underline prose-a:decoration-[rgba(0,0,0,0.40)] prose-a:decoration-dashed prose-a:decoration-[1px] prose-a:underline-offset-4 prose-a:transition-all prose-a:duration-200 prose-a:ease-in-out hover:prose-a:decoration-[rgba(0,0,0,0.70)] dark:prose-a:text-white dark:prose-a:decoration-[rgba(255,255,255,0.40)] dark:hover:prose-a:decoration-[rgba(255,255,255,0.70)] prose-a:sm:break-words;
    @apply prose-pre:px-0;

    > * {
      &:first-child {
        @apply mt-0;

        [data-rmiz] img {
          @apply mt-0;
        }
      }

      &:last-child {
        @apply mb-0;
      }
    }

    > .prose-doc {
      @apply mt-10;
    }

    h2 {
      @apply m-0 pt-8 text-[28px] font-medium leading-tight tracking-tighter;
    }

    h3 {
      @apply text-xl font-medium leading-snug tracking-extra-tight;
    }

    h4 {
      @apply text-lg font-medium leading-snug tracking-extra-tight;
    }

    p {
      @apply mb-6 mt-[18px] text-lg font-normal leading-normal tracking-tight text-black-new dark:text-gray-new-85;
    }

    .admonition h4 {
      @apply m-0 inline-flex items-center font-mono text-[13px] uppercase leading-none;
    }

    .anchor-heading {
      @apply scroll-mt-24 lg:scroll-mt-5;
    }

    p > img {
      @apply rounded border border-gray-new-94 dark:border-gray-new-20;

      &.no-border {
        @apply border-0;
      }
    }

    ul,
    ol {
      @apply my-3 list-none;

      > li {
        @apply relative my-2.5 pl-0;

        ol {
          @apply md:pl-4;
        }
      }
    }

    ul {
      @apply my-6 pl-[34px] md:pl-4;

      > li {
        @apply text-[18px] font-normal leading-normal text-gray-new-30 dark:text-gray-new-85;
        &::before {
          @apply absolute -left-4 top-0 text-[18px] font-normal leading-normal text-gray-new-30 content-['-'] dark:text-gray-new-85 md:-left-3.5;
        }
      }
    }

    ol {
      @apply list-decimal pl-[38px] md:pl-5;

      li {
        @apply pl-1.5;

        &::marker {
          @apply pl-1 text-black-new dark:text-gray-new-90;
        }
      }

      ol {
        list-style-type: lower-alpha;
      }
    }

    hr {
      @apply my-8;
    }

    h2,
    h3 {
      & + hr {
        @apply mt-0;
      }
    }

    .table-wrapper {
      @apply 2xl:-mx-4 2xl:overflow-x-auto 2xl:px-4;
    }

    table {
      @apply my-10 w-full leading-normal 2xl:min-w-[500px];

      th {
        @apply p-2.5 pt-0 text-left align-top;
      }

      td {
        @apply p-2.5;
      }

      thead {
        tr {
          @apply border-b border-gray-new-90 dark:border-gray-new-20;
        }
      }

      tbody {
        tr {
          @apply border-b border-gray-new-90 text-gray-new-30 dark:border-gray-new-20 dark:text-white;
        }
      }
    }

    .code-tab {
      > pre {
        @apply my-0 py-7;
      }
    }

    pre {
      &.highlight {
        @apply px-0;

        > code {
          @apply inline-block w-full px-6 py-1.5 !leading-relaxed wrap-anywhere;
        }
      }

      > code {
        text-shadow: unset;

        @apply !font-mono text-sm !leading-[1.75] !text-black-new dark:!text-white dark:![text-shadow:unset];
      }
    }

    :not(pre) > code {
      @apply break-words rounded border border-gray-new-90 bg-gray-new-94 !px-1 !py-px !font-mono text-sm !font-normal tracking-extra-tight !text-black-new dark:border-gray-new-30 dark:bg-black dark:!text-white;

      &::before,
      &::after {
        @apply hidden;
      }
    }

    .code-wrap {
      code {
        white-space: break-spaces !important;

        @apply !max-w-full !break-words;
      }
    }

    iframe,
    video {
      @apply mx-auto my-5 rounded-md;
    }

    .gatsby-resp-image-wrapper {
      @apply my-5;
    }

    blockquote {
      @apply font-normal not-italic;

      p {
        @apply my-0 text-lg font-normal leading-normal tracking-tight text-gray-new-8 dark:text-gray-new-85;

        &::before,
        &::after {
          @apply hidden;
        }
      }

      cite,
      footer {
        @apply mt-5 flex items-center gap-2.5 text-sm font-medium leading-tight tracking-tight text-gray-new-8 dark:text-gray-new-90;
      }
    }

    /* Details/Summary dropdown styling */
    details {
      @apply relative -mb-px border border-gray-new-90 bg-transparent p-4 dark:border-gray-new-20;
    }

    details summary {
      @apply flex cursor-pointer items-center gap-2 text-base font-normal leading-normal tracking-tight text-black-new dark:text-white;
      list-style: none;

      &::-webkit-details-marker {
        @apply hidden;
      }

      &::marker {
        @apply hidden;
      }

      &::before {
        @apply size-3.5 shrink-0 origin-center rotate-0 bg-current transition-transform duration-200 ease-linear content-[''] [clip-path:polygon(30%_22%,30%_78%,78%_50%)];
      }
    }

    details[open] > summary::before {
      transform: rotate(90deg);
    }

    details > *:not(summary) {
      @apply mt-6 pl-[26px] text-base font-normal leading-normal tracking-tight text-gray-new-30 dark:text-gray-new-85;
    }

    /* Ensure list items inside details have proper spacing */
    details ul {
      @apply mb-0;
    }

    details ul > li:last-child {
      @apply mb-0;
    }

    /* Mermaid diagram styles */
    .mermaid-container {
      @apply my-8 overflow-x-auto rounded-lg border border-gray-new-94 bg-white p-6 dark:border-gray-new-20 dark:bg-gray-new-10;
    }
  }

  .prose-chat {
    > * {
      &:first-child {
        @apply mt-0;
      }

      &:last-child {
        @apply mb-0;
      }
    }

    pre {
      @apply overflow-x-auto rounded-md !bg-gray-new-94/60 dark:!bg-gray-new-15;
    }

    :not(pre) > code {
      @apply bg-gray-new-90 dark:bg-gray-new-15;
    }
  }

  .prose-static {
    @apply prose-ol:list-none;

    ol {
      counter-reset: item;
      @apply m-0 p-0;
    }

    ol > li {
      display: table;
      counter-increment: item;
      @apply mb-[0.6em];
    }

    ol > li ol {
      @apply md:pl-0;
    }

    ol > li:before {
      content: counters(item, '.') '. ';
      display: table-cell;
      @apply pr-[0.6em];
    }

    li ol > li {
      @apply m-0;
    }

    li ol > li:before {
      content: counters(item, '.') ' ';
    }

    .wp-block-table {
      @apply md:-mx-4 md:overflow-x-auto md:px-4;
    }
  }

  .prose-variable {
    @apply text-lg tracking-extra-tight text-gray-new-70 sm:text-base;

    p,
    ul {
      @apply mt-7 xl:mt-6 lg:mt-5 sm:mt-4;
    }

    strong {
      @apply font-medium text-white;
    }

    a {
      @apply text-green-45 transition-colors duration-200 hover:text-[#47ffc2];
    }
  }

  .prose-flow {
    > p {
      @apply my-6;
    }

    > ul,
    > ol {
      @apply my-6;

      > li {
        @apply my-4;
      }
    }
  }

  /* Split layout for SDK reference pages (2-column grid) */
  .split-layout {
    @apply grid grid-cols-2 gap-x-10 xl:grid-cols-1 xl:gap-x-0;

    > h2,
    > h3,
    > h4,
    > p,
    > ul,
    > ol,
    > blockquote {
      @apply col-start-1;
    }

    > figure,
    > pre,
    > .code-block,
    > [class*='code-tabs'] {
      @apply col-start-2 self-start xl:col-start-1 xl:mt-6;
    }

    /* Group consecutive description elements together */
    > h2 {
      @apply col-span-2 xl:col-span-1;
    }

    /* Code blocks should stick to the right column */
    > figure + figure,
    > pre + pre,
    > .code-block + .code-block {
      @apply mt-6;
    }
  }
}
